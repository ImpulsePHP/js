!function(){"use strict";function t(t){t.style.opacity="0",t.style.transform="translateY(-60px)",setTimeout(()=>t.remove(),400)}function e(t){if(t.id)return`#${t.id}`;const e=["name","data-action-input","data-action-change","placeholder","type"];for(const n of e){const e=t.getAttribute(n);if(e)return`[${n}="${e}"]`}let n=t.tagName.toLowerCase();if(t.parentElement){const e=Array.from(t.parentElement.children).indexOf(t);e>-1&&(n+=`:nth-child(${e+1})`)}return n}const n=new class{constructor(){this.counters=new Map}init(){this.bindElements(),this.setupMutationObserver()}bindElements(){document.querySelectorAll("[data-character-counter]").forEach(t=>this.bindElement(t))}bindElement(t){const e=t.getAttribute("data-character-counter");if(e)try{const n=JSON.parse(e),a=t.id||`counter_${Date.now()}_${Math.random()}`;let s;if(s=n.target?document.querySelector(n.target):t.parentElement?.querySelector("[data-character-display]")||null,!s)return void console.warn("Counter display element not found for:",t);this.counters.set(a,{input:t,counter:s,config:n}),this.bindEvents(a),this.updateCounter(a)}catch(t){console.error("Invalid character counter configuration:",e,t)}}bindEvents(t){const e=this.counters.get(t);if(!e)return;const{input:n}=e;["input","keyup","paste","cut"].forEach(e=>{n.addEventListener(e,()=>{setTimeout(()=>this.updateCounter(t),0)})})}updateCounter(t){const e=this.counters.get(t);if(!e)return;const{input:n,counter:a,config:s}=e,o=this.getTextLength(n.value),{maxLength:i,mode:r}=s;let l,c;if("countdown"===r){const t=i-o;t>=0?(l=`${t} caractères restants`,c=t<.1*i?"text-yellow-600":"text-slate-500"):(l=`Dépassement de ${Math.abs(t)} caractères`,c="text-red-600")}else l=`${o}/${i} caractères`,c=o>i?"text-red-600":o>.9*i?"text-yellow-600":"text-slate-500";a.textContent=l,a.className=a.className.replace(/text-(slate|yellow|red)-\d+/g,"")+` ${c}`}getTextLength(t){return[...t].length}setupMutationObserver(){new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(t=>{if(t.nodeType===Node.ELEMENT_NODE){const e=t;e.hasAttribute("data-character-counter")&&this.bindElement(e),e.querySelectorAll("[data-character-counter]").forEach(t=>this.bindElement(t))}})})}).observe(document.body,{childList:!0,subtree:!0})}destroy(t){t?this.counters.delete(t):this.counters.clear()}},a=new WeakMap,s=new WeakMap;function o(t,e){const n=parseInt(t.dataset.actionDebounce||"0",10),s=parseInt(t.dataset.actionThrottle||"0",10);if(n>0){clearTimeout(a.get(t));const o=setTimeout(()=>i(t,e,s),n);return void a.set(t,o)}i(t,e,s)}function i(t,e,n){const a=s.get(t)||0,o=Date.now();if(n>0&&o-a<n)return;s.set(t,o);const i=e();i&&"function"==typeof i.then&&i.catch(t=>{console.error("❌ Action failed:",t)})}function r(){document.querySelectorAll("[data-action-click]").forEach(t=>{t._impulseBoundClick||(t._impulseBoundClick=!0,t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();const n=t.getAttribute("data-action-click"),a=t.closest("[data-impulse-id]");if(!n||!a)return;const s=a.getAttribute("data-impulse-id");let i=t.getAttribute("data-action-update")||void 0;o(t,()=>I(s,n,void 0,{update:i}))}))}),document.querySelectorAll("[data-action-input]").forEach(t=>{t._impulseBoundInput||(t._impulseBoundInput=!0,t.addEventListener("input",n=>{const a=t.getAttribute("data-action-input"),s=t.closest("[data-impulse-id]");if(!a||!s)return;const i=s.getAttribute("data-impulse-id"),r=n.target.value;let l=t.getAttribute("data-action-update")||void 0;const c=document.activeElement,d=c===t,u=d?c.selectionStart:null,m=d?c.selectionEnd:null;o(t,()=>I(i,a,r,{activeElementId:d&&""!==c.id?.trim()?c.id:null,activeElementSelector:d?e(c):null,selectionStart:u,selectionEnd:m,caretPosition:u,update:l}))}))}),document.querySelectorAll("[data-action-change]").forEach(t=>{t._impulseBoundChange||(t._impulseBoundChange=!0,t.addEventListener("change",n=>{const a=t.getAttribute("data-action-change"),s=t.closest("[data-impulse-id]");if(!a||!s)return;const i=s.getAttribute("data-impulse-id"),r=n.target.value;let l=t.getAttribute("data-action-update")||void 0;const c=void 0!==t.selectedIndex?t.selectedIndex:-1;o(t,()=>I(i,a,r,{activeElementId:t.id,activeElementSelector:e(t),selectedIndex:c,update:l}))}))}),document.querySelectorAll("[data-action-blur]").forEach(t=>{t._impulseBoundBlur||(t._impulseBoundBlur=!0,t.addEventListener("blur",e=>{const n=t.getAttribute("data-action-blur"),a=t.closest("[data-impulse-id]");if(!n||!a)return;const s=a.getAttribute("data-impulse-id"),i=e.target.value;let r=t.getAttribute("data-action-update")||void 0;o(t,()=>I(s,n,i,{update:r}))}))}),document.querySelectorAll("[data-action-keydown]").forEach(t=>{t._impulseBoundKeyDown||(t._impulseBoundKeyDown=!0,t.addEventListener("keydown",e=>{const n=t.getAttribute("data-action-keydown"),a=t.closest("[data-impulse-id]");if(!n||!a)return;const s=a.getAttribute("data-impulse-id");let i=t.getAttribute("data-action-update")||void 0;const r=e.key;o(t,()=>I(s,`${n}('${r}')`,void 0,{update:i}))}))}),document.querySelectorAll("[data-action-submit]").forEach(t=>{t._impulseBoundSubmit||(t._impulseBoundSubmit=!0,t.addEventListener("submit",e=>{e.preventDefault();const n=t.getAttribute("data-action-submit"),a=t.closest("[data-impulse-id]")?.getAttribute("data-impulse-id");if(!n||!a)return;let s=t.getAttribute("data-action-update")||void 0;o(t,()=>I(a,n,void 0,{update:s}))}))}),document.querySelectorAll("[data-action-emit]").forEach(t=>{if(t._impulseBoundEmit)return;t._impulseBoundEmit=!0;const e="form"===t.tagName.toLowerCase(),n=e?"submit":"click";t.addEventListener(n,n=>{n.preventDefault();const a=t.getAttribute("data-action-emit");if(!a)return;let s={};if(e)new FormData(t).forEach((t,e)=>s[e]=t);else{const e=t.getAttribute("data-payload");if(e)try{s=JSON.parse(e)}catch(t){s={value:e}}}o(t,()=>Impulse.emit(a,s,{callback:e=>{"function"==typeof t._onImpulseResult?t._onImpulseResult(e):t.dispatchEvent(new CustomEvent("data-emit-result",{detail:e,bubbles:!0}))}}))})}),n.init()}var l=Object.freeze({__proto__:null,bindImpulseEvents:r});let c=Date.now(),d="";function u(){const t=JSON.stringify(m());return btoa(btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(t,e)=>String.fromCharCode(parseInt(e,16)))))}function m(){const t={};for(let e=0;e<localStorage.length;e++){const n=localStorage.key(e);if(null!==n){let e=localStorage.getItem(n);e&&"object"==typeof e&&(e=JSON.stringify(e)),t[n]=e}}return t}async function h(t=!1){try{const e=u();if(!t&&e===d)return;d=e;const n=Date.now(),a={_local_storage:m(),_metadata:{timestamp:n,previous_timestamp:c,force_refresh:t}};c=n;const s=await fetch(window.location.href,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","X-LocalStorage-Sync":"1","Cache-Control":"no-cache, no-store, must-revalidate"},body:JSON.stringify(a)});s.ok||console.warn(`Synchronization failed: ${s.status}`),t&&await s.json()}catch(t){console.error("Error while synchronizing localStorage:",t)}}function p(){return h(!0)}const f=new Set;let g=new Set;function y(){g.clear();for(let t=0;t<localStorage.length;t++){const e=localStorage.key(t);null!==e&&g.add(e)}}function v(){y();const t=localStorage.setItem,e=localStorage.removeItem,n=localStorage.clear,a=document.documentElement.lang||null;localStorage.setItem=function(e,n){t.call(localStorage,e,n),g.add(e),f.delete(e),setTimeout(()=>h(),0)},localStorage.removeItem=function(t){null!==localStorage.getItem(t)&&(f.add(t),g.delete(t)),e.call(localStorage,t),setTimeout(()=>h(),0)},localStorage.clear=function(){for(let t=0;t<localStorage.length;t++){const e=localStorage.key(t);null!==e&&f.add(e)}g.clear(),n.call(localStorage),setTimeout(()=>h(),0)},window.addEventListener("storage",t=>{null===t.key?y():null===t.newValue?(g.delete(t.key),f.add(t.key)):(g.add(t.key),f.delete(t.key)),setTimeout(()=>h(),0)}),document.addEventListener("DOMContentLoaded",()=>{h(!0).then(()=>{console.log("localStorage synchronised on initial load")})}),window.addEventListener("beforeunload",()=>{const t=new XMLHttpRequest;t.open("POST",window.location.href,!1),a&&t.setRequestHeader("Accept-Language",a),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("X-LocalStorage-Sync","1"),t.send(JSON.stringify({_local_storage:m(),_metadata:{timestamp:Date.now(),previous_timestamp:c,deleted_keys:Array.from(f)}}))});const s=history.pushState;history.pushState=function(){return h(),s.apply(this,[...arguments])}}function E(t,e){try{localStorage.setItem(t,JSON.stringify(e)),document.dispatchEvent(new CustomEvent("impulse-local-storage",{detail:{key:t,value:e}}))}catch(e){console.warn(`Error storing ${t} in localStorage`,e)}}function w(t){if(!t)return;const e=t.replace(/<\/?style[^>]*>/g,"").trim();if(!e)return;document.querySelectorAll("style#impulse-dynamic-styles").forEach((t,e)=>{e>0&&t.remove()});let n=document.querySelector("style#impulse-dynamic-styles");n||(n=document.createElement("style"),n.id="impulse-dynamic-styles",document.head.appendChild(n)),n.textContent?.includes(e)||(n.textContent+="\n"+e)}async function b(e,n){const a=window.__impulseComponents,s=document.documentElement.lang||null,o={"Content-Type":"application/json","X-Impulse-Components":Array.isArray(a)||a instanceof Set?Array.from(a).join(","):""};s&&(o["Accept-Language"]=s);const i=await fetch("/impulse.php",{method:"POST",headers:o,body:JSON.stringify(e)}),r=await i.text();if(i.headers.get("content-type")?.includes("application/json")||r.trim().startsWith("{")&&r.trim().endsWith("}"))try{const e=JSON.parse(r);if(e.updates&&Array.isArray(e.updates)&&e.updates.forEach(t=>{A(t.component,t.html,n)}),e.styles&&w(e.styles),e.events&&e.events.forEach(([t,e])=>{window.Impulse&&window.Impulse.emit&&window.Impulse.emit(t,e)}),e.localStorage&&"object"==typeof e.localStorage)for(const[t,n]of Object.entries(e.localStorage))E(t,n);if(e.error)return function(e){let n=document.getElementById("impulse-error-container");if(n||(n=document.createElement("div"),n.id="impulse-error-container",n.style.position="fixed",n.style.top="1rem",n.style.left="50%",n.style.transform="translateX(-50%)",n.style.zIndex="9999",n.style.pointerEvents="none",n.style.width="425px",document.body.appendChild(n)),Array.from(n.children).some(t=>t.textContent?.replace(/\s+/g," ").includes(e)))return;const a=document.createElement("div");a.style.background="#e11d48",a.style.color="#fff",a.style.padding="12px",a.style.fontFamily="sans-serif",a.style.borderRadius="6px",a.style.boxShadow="0 2px 12px #0003",a.style.opacity="1",a.style.minWidth="280px",a.style.pointerEvents="auto",a.style.transition="opacity 0.4s, transform 0.4s",a.style.marginTop="6px",a.style.marginBottom="0",a.style.display="flex",a.style.alignItems="center",a.style.fontSize="0.9rem",a.innerHTML=`\n    <span style="vertical-align:middle;">${e}</span>\n    <button style="margin-left:24px;background:transparent;border:none;color:#fff;font-size:22px;cursor:pointer;vertical-align:middle;" aria-label="Close">&times;</button>\n  `,a.querySelector("button").addEventListener("click",()=>t(a)),n.appendChild(a),setTimeout(()=>t(a),6e3)}(e.message),Promise.reject(e.error)}catch(t){console.warn("Impulse: failed to parse response or malformed data.",{text:r,error:t})}return null}function S(t,e){setTimeout(()=>{const n=function(t,e){let n=null;if(e.activeElementId&&""!==e.activeElementId.trim()&&(n=document.getElementById(e.activeElementId)),!n&&e.activeElementSelector)try{e.activeElementId&&(n=t.querySelector(`#${e.activeElementId}`)),n||(n=t.querySelector(e.activeElementSelector))}catch(t){console.warn("Unable to find the element using selector:",e.activeElementSelector,". Add an ID to your element to make it accessible. Error:",t)}return n}(t,e);n&&("SELECT"===n.tagName&&"number"==typeof e.selectedIndex&&(n.selectedIndex=e.selectedIndex),"focus"in n&&n.focus(),"setSelectionRange"in n&&"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd&&requestAnimationFrame(()=>{n.setSelectionRange(e.selectionStart,e.selectionEnd)}))},0)}async function A(t,e,n){const a=function(t){const e=new Map;return t.querySelectorAll("[data-save-scroll]").forEach((t,n)=>{const a=t;if(a.scrollTop>0){const t=a.getAttribute("data-save-scroll"),s=t&&""!==t?t:`scroll-${n}`;e.set(s,a.scrollTop)}}),e}(document.body),s=document.createElement("div");s.innerHTML=e;const o=s.querySelector("[data-impulse-id]");try{const n=JSON.parse(e);if(n&&"object"==typeof n&&n.fragments){if(Object.entries(n.fragments).forEach(([t,e])=>{const[n,a]=t.split("@"),s=`[data-update^="${n}@"]`;document.querySelectorAll(s).forEach(t=>{const n=t.getAttribute("data-update");if(!n)return;const s=n.split("@")[1];if(s&&s===a){const n=document.createElement("div");n.innerHTML=e.trim();const a=n.firstElementChild;a?t.replaceWith(a):t.innerHTML=e}})}),n.styles&&w(n.styles),n.events&&n.events.forEach(([t,e])=>{window.Impulse&&window.Impulse.emit&&window.Impulse.emit(t,e)}),n.states){const e=document.querySelector(`[data-impulse-id="${t}"]`);e&&e.setAttribute("data-states",JSON.stringify(n.states))}if(n.localStorage&&"object"==typeof n.localStorage)for(const[t,e]of Object.entries(n.localStorage))E(t,e);return void r()}}catch(t){}if(function(t,e){const n=n=>{setTimeout(()=>{t.querySelectorAll("[data-save-scroll]").forEach((t,n)=>{const a=t,s=a.getAttribute("data-save-scroll"),o=s&&""!==s?s:`scroll-${n}`,i=e.get(o);void 0!==i&&i>0&&(a.scrollTop=i,setTimeout(()=>{Math.abs(a.scrollTop-i)>5&&(a.scrollTop=i)},10))})},n)};n(0),n(10),n(50)}(document.body,a),n?.update){let a=null;try{const t=JSON.parse(e);t&&"object"==typeof t&&t.result&&(e=t.result,a=t.states)}catch(t){}const s=document.querySelector(`[data-impulse-id="${t}"]`),o=s?.querySelector(`[data-update="${n.update}"]`);if(o){const t=document.createElement("div");t.innerHTML=e.trim();const i=t.firstElementChild;return void(i?(o.replaceWith(i),a&&s&&s.setAttribute("data-states",JSON.stringify(a)),n&&S(i,n)):(o.innerHTML=e,a&&s&&s.setAttribute("data-states",JSON.stringify(a)),n&&S(o,n)))}}const i=document.querySelector(`[data-impulse-id="${t}"]`);if(o&&i&&i.parentNode){const t=i.getAttribute("class")||"",e=o.getAttribute("class")||"";if(t){const n=t.split(" ").filter(t=>""!==t.trim()),a=e.split(" ").filter(t=>""!==t.trim()),s=[...new Set([...n,...a])];s.length>0&&o.setAttribute("class",s.join(" "))}["style","title"].forEach(t=>{const e=i.getAttribute(t);e&&!o.hasAttribute(t)&&o.setAttribute(t,e)});const a=["data-impulse-id","data-states","data-slot"];Array.from(i.attributes).forEach(t=>{(t.name.startsWith("data-")&&!a.includes(t.name)||t.name.startsWith("aria-"))&&(o.hasAttribute(t.name)||o.setAttribute(t.name,t.value))}),i.parentNode.replaceChild(o,i),L(),r(),n&&S(o,n)}}async function I(t,e,n,a){const s=function(t){const e=document.querySelector(`[data-impulse-id="${t}"]`);let n={};if(e&&e.hasAttribute("data-states"))try{n=JSON.parse(e.getAttribute("data-states")||"{}")}catch(t){n={}}if(e){if(e.classList.contains("ui-checkbox-radio")||t.includes("checkbox-radio")){const t=e.querySelectorAll('input[type="radio"]'),a=e.querySelectorAll('input[type="checkbox"]');if(t.length>0){const e=t[0].name;t.forEach(t=>{t.checked&&t.value&&(n[e]=t.value)})}if(a.length>0){const t=JSON.parse(e.getAttribute("data-states")||"{}").name||"value";if(1===a.length){const e=a[0];n[t]=e.checked}else{const e=[];a.forEach(t=>{t.checked&&e.push(t.name)}),n[t]=e}}return n}e.querySelectorAll("[data-action-input], [data-action-change], [name], [id]").forEach(t=>{const e=t.getAttribute("name")||t.getAttribute("id");if(e)if("checkbox"===t.type)n[e]=t.checked;else if("radio"===t.type)t.checked&&(n[e]=t.value);else if("SELECT"===t.tagName){const a=t;a.multiple?n[e]=Array.from(a.selectedOptions).map(t=>t.value):n[e]=a.value}else n[e]=t.value})}return n}(t),o={id:t,action:e,states:s};a?.update&&(o.update=a.update),void 0!==n&&(o.value=n),o._local_storage=m();const i=document.querySelector(`[data-impulse-id="${t}"]`),r=i?.getAttribute("data-slot");r&&(o.slot=atob(r));try{const e=await b(o,a);e&&await A(t,e,a)}catch(t){console.error("Impulse error:",t)}}async function T(t,e={},n={}){const a=(s=n.components)?Array.isArray(s)?s:[s]:Array.from(document.querySelectorAll("[data-impulse-id]")).map(t=>t.getAttribute("data-impulse-id")).filter(Boolean);var s;const o=m(),i=document.documentElement.lang||null,l={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...n.headers||{}};i&&(l["Accept-Language"]=i);const c=await fetch("/impulse.php",{method:"POST",headers:l,body:JSON.stringify({emit:t,payload:e,components:a,_local_storage:o,...n.extra}),credentials:"same-origin"});let d={};try{d=await c.json(),document.dispatchEvent(new CustomEvent("data-action-emit",{detail:{event:t,payload:e}})),d.updates&&(d.updates.forEach(t=>{A(t.component,t.html)}),r()),d.styles&&w(d.styles),d.localStorage&&Object.keys(d.localStorage).forEach(t=>{const e=d.localStorage[t];null===e?localStorage.removeItem(t):localStorage.setItem(t,e)})}catch(t){}return"function"==typeof n.callback&&n.callback(d),d}function L(){window.__impulseComponents=new Set(Array.from(document.querySelectorAll("[data-impulse-id]")).map(t=>t.getAttribute("data-impulse-id")).filter(t=>null!==t))}function C(t){let e=Array.from(document.querySelectorAll(t));if(t.startsWith("#")){const n=t.slice(1);e=e.concat(Array.from(document.querySelectorAll(`[data-impulse-id="${n}"]`)))}return Array.from(new Set(e))}function x(t){let e=document.querySelector(t);if(!e&&t.startsWith("#")){const n=t.slice(1);e=document.querySelector(`[data-impulse-id="${n}"]`)}return e}(()=>{function t(t,e){performance.now();let n=0;const a=document.documentElement.lang||null,s={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"};a&&(s["Accept-Language"]=a),fetch(t,{method:"POST",headers:s,body:JSON.stringify({_local_storage:m(),_locale:a})}).then(async t=>{if((t.headers.get("Content-Type")||"").includes("application/json")){const e=await t.json();return e.redirect?(window.location.replace(e.redirect),Promise.reject("ImpulseRedirect")):!1!==e.redirect&&t.ok?(console.warn("Unrecognized JSON:",e),""):Promise.reject("ImpulseBlocked")}if(!t.ok)return Promise.reject("HttpError");const e=t.headers.get("content-length");return e&&(n=parseInt(e,10)),t.text()}).then(a=>{performance.now(),0===n&&(n=new Blob([a]).size);const s=(new DOMParser).parseFromString(a,"text/html");if(s.head){const t=["META","LINK","TITLE","SCRIPT"],e=Array.from(s.head.children).filter(e=>t.includes(e.tagName));Array.from(document.body.children).forEach(n=>{t.includes(n.tagName)&&e.some(t=>t.isEqualNode(n))&&n.remove()});const n=[...Array.from(document.head.children).filter(t=>t.hasAttribute("data-persistent")),...e];document.head.innerHTML="",n.forEach(t=>{document.head.appendChild(t.cloneNode(!0))})}const o=s.querySelector("#app"),i=document.querySelector("#app");o&&i?i.replaceWith(o):console.warn("Router: unable to find #app"),L(),Promise.resolve().then(function(){return l}).then(t=>{t.bindImpulseEvents()}),e&&history.pushState(null,"",t)}).catch(t=>{"ImpulseRedirect"!==t&&"ImpulseBlocked"!==t&&"HttpError"!==t&&console.error("Failed to fetch page:",t)})}document.addEventListener("DOMContentLoaded",()=>{h(),window.dispatchEvent(new CustomEvent("impulse:page-loaded",{detail:{url:window.location.href,route:window.location.pathname}}))}),document.addEventListener("click",e=>{const n=e.target.closest("a");n&&(n.getAttribute("data-router")||(e.preventDefault(),t(n.href,!0)))}),window.addEventListener("popstate",()=>{t(window.location.href,!1)})})();class q{constructor(t,e,n={}){this.items=[],this.noResultsElement=null,this.searchInput=t,this.itemsContainer=e,this.config={caseSensitive:"true"===n.caseSensitive,exactMatch:"true"===n.exactMatch,wordSearch:"true"===n.wordSearch,minLength:parseInt(n.minLength)||0,noResultsMessage:n.noResultsMessage||"Aucun résultat trouvé",hiddenClass:n.hiddenClass||"hidden",searchFields:n.searchFields?.split(",")||["textContent","data-search-text","data-label"],mode:n.mode||"contains"},this.init()}init(){this.refreshItems(),this.attachEvents()}attachEvents(){this.searchInput.addEventListener("input",t=>{const e=t.target.value;this.performSearch(e)}),this.searchInput.addEventListener("keydown",t=>{"Escape"===t.key&&this.clearSearch()})}refreshItems(){const t=this.itemsContainer.getAttribute("data-search-items")||"li, [data-searchable], .searchable-item",e=this.itemsContainer.querySelectorAll(t);this.items=Array.from(e).map(t=>({element:t,searchText:this.extractSearchText(t),value:this.extractValue(t),data:this.extractData(t)}))}extractSearchText(t){for(const e of this.config.searchFields){let n="";if("textContent"===e)n=t.textContent?.trim()||"";else if(e.startsWith("data-"))n=t.getAttribute(e)||"";else{const a=t.querySelector(e);n=a?.textContent?.trim()||""}if(n)return n}return t.textContent?.trim()||""}extractValue(t){return t.getAttribute("data-value")||t.getAttribute("value")||this.extractSearchText(t)}extractData(t){const e={},n=Array.from(t.attributes);for(const t of n)t.name.startsWith("data-")&&(e[t.name.slice(5)]=t.value);return e}performSearch(t){const e=t.trim();if(e.length<this.config.minLength)return this.showAllItems(),void this.hideNoResults();const n=this.config.caseSensitive?e:e.toLowerCase(),a=[];for(const t of this.items){const e=this.config.caseSensitive?t.searchText:t.searchText.toLowerCase();this.matchesQuery(e,n)?(this.showItem(t.element),a.push(t)):this.hideItem(t.element)}0===a.length?this.showNoResults():this.hideNoResults(),this.itemsContainer.dispatchEvent(new CustomEvent("live-search",{detail:{query:e,visibleItems:a,totalItems:this.items.length}}))}matchesQuery(t,e){switch(this.config.mode){case"startsWith":return t.startsWith(e);case"fuzzy":return this.fuzzyMatch(t,e);default:if(this.config.wordSearch){const n=e.split(/\s+/),a=t.split(/\s+/);return n.every(t=>a.some(e=>e.includes(t)))}return t.includes(e)}}fuzzyMatch(t,e){let n=0;for(let a=0;a<t.length&&n<e.length;a++)t[a]===e[n]&&n++;return n===e.length}showItem(t){this.config.hiddenClass&&t.classList.remove(this.config.hiddenClass),t.style.display=""}hideItem(t){this.config.hiddenClass?t.classList.add(this.config.hiddenClass):t.style.display="none"}showAllItems(){this.items.forEach(t=>this.showItem(t.element))}showNoResults(){this.noResultsElement=this.itemsContainer.querySelector("[data-no-results]"),this.noResultsElement||(this.noResultsElement=document.createElement("div"),this.noResultsElement.setAttribute("data-no-results",""),this.noResultsElement.className="p-3 text-sm text-slate-500 text-center",this.itemsContainer.appendChild(this.noResultsElement)),this.noResultsElement.textContent=this.config.noResultsMessage,this.noResultsElement.style.display=""}hideNoResults(){this.noResultsElement&&(this.noResultsElement.style.display="none")}clearSearch(){this.searchInput.value="",this.showAllItems(),this.hideNoResults()}refresh(){this.refreshItems()}destroy(){}}function _(){document.querySelectorAll("[data-live-search]").forEach(t=>{const e=t.querySelector("[data-search-input]"),n=t.querySelector("[data-search-container]")||t;if(!e)return void console.warn("LiveSearch: data-search-input not found in container",t);const a={caseSensitive:t.getAttribute("data-search-case-sensitive"),exactMatch:t.getAttribute("data-search-exact-match"),wordSearch:t.getAttribute("data-search-word-match"),minLength:t.getAttribute("data-search-min-length"),noResultsMessage:t.getAttribute("data-search-no-results-message"),hiddenClass:t.getAttribute("data-search-hidden-class"),searchFields:t.getAttribute("data-search-fields"),mode:t.getAttribute("data-search-mode")};new q(e,n,a)})}"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",_):_(),document.addEventListener("impulse:component-updated",_),function t(){document.body?new MutationObserver(()=>{setTimeout(_,50)}).observe(document.body,{childList:!0,subtree:!0}):"loading"===document.readyState&&document.addEventListener("DOMContentLoaded",t)}());const k=new class{constructor(){this.activeTimers=new Map,this.config={animationDuration:300,progressUpdateInterval:100}}initializeToast(t){const e="true"===t.dataset.toastAutoHide,n=parseInt(t.dataset.toastTimer||"0",10),a=t.dataset.toastId||t.id||`toast-${Date.now()}`;if(!e||n<=0)return;this.clearTimer(a);const s={intervalId:0,startTime:Date.now(),pauseTime:null,totalPauseDuration:0},o=()=>{const e=Date.now()-s.startTime-s.totalPauseDuration,i=Math.max(0,n-e);this.updateProgressBar(t,i,n),i<=0?this.dismissToast(t,a):s.intervalId=window.setTimeout(o,this.config.progressUpdateInterval)};s.intervalId=window.setTimeout(o,this.config.progressUpdateInterval),this.activeTimers.set(a,s),this.setupHoverHandlers(t,a,s,n)}updateProgressBar(t,e,n){const a=t.querySelector("[data-toast-progress]");if(!a)return;const s=e/n*100;a.style.width=`${s}%`}setupHoverHandlers(t,e,n,a){const s=()=>{null===n.pauseTime&&(n.pauseTime=Date.now(),clearTimeout(n.intervalId),t.classList.add("toast-paused"),this.emitLocalEvent("toast:paused",{toastId:e,element:t}))},o=()=>{if(null===n.pauseTime)return;n.totalPauseDuration+=Date.now()-n.pauseTime,n.pauseTime=null,t.classList.remove("toast-paused");const s=Date.now()-n.startTime-n.totalPauseDuration;Math.max(0,a-s)>0?(this.restartTimer(t,e,n,a),this.emitLocalEvent("toast:resumed",{toastId:e,element:t})):this.dismissToast(t,e)};t.addEventListener("mouseenter",s),t.addEventListener("mouseleave",o),t.addEventListener("focusin",s),t.addEventListener("focusout",o)}restartTimer(t,e,n,a){const s=()=>{const o=Date.now()-n.startTime-n.totalPauseDuration,i=Math.max(0,a-o);this.updateProgressBar(t,i,a),i<=0?this.dismissToast(t,e):n.intervalId=window.setTimeout(s,this.config.progressUpdateInterval)};n.intervalId=window.setTimeout(s,this.config.progressUpdateInterval)}dismissToast(t,e){this.clearTimer(e),t.style.transition=`all ${this.config.animationDuration}ms ease-out`,t.style.transform="translateX(100%)",t.style.opacity="0",setTimeout(()=>{const n=t.closest("[data-impulse-id]")?.getAttribute("data-impulse-id");n&&window.Impulse?.emit&&window.Impulse.emit("component:call",{componentId:n,method:"hide",params:[]}),this.emitLocalEvent("toast:dismissed",{toastId:e,element:t})},this.config.animationDuration)}emitLocalEvent(t,e){window.Impulse?.emitEvent&&window.Impulse.emitEvent(t,e),document.dispatchEvent(new CustomEvent(t,{detail:e}))}clearTimer(t){const e=this.activeTimers.get(t);e&&(clearTimeout(e.intervalId),this.activeTimers.delete(t))}clearAllTimers(){this.activeTimers.forEach(t=>clearTimeout(t.intervalId)),this.activeTimers.clear()}observeToasts(){const t=new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(t=>{if(t.nodeType===Node.ELEMENT_NODE){const e=t;e.classList?.contains("ui-toast")&&this.initializeToast(e);const n=e.querySelectorAll?.(".ui-toast");n?.forEach(t=>this.initializeToast(t))}})})});return t.observe(document.body,{childList:!0,subtree:!0}),t}initializeExistingToasts(){document.querySelectorAll(".ui-toast").forEach(t=>this.initializeToast(t))}};function N(){r(),document.addEventListener("click",t=>{const e=t.target.closest("[data-toggle], [data-show], [data-hide], [data-close], [data-toggle-class], [data-scrollto]");if(e){if(e.dataset.toggle){const t=e.dataset.toggle,n=e.getAttribute("data-toggle-group");n&&document.querySelectorAll(`[data-toggle][data-toggle-group="${n}"]`).forEach(t=>{if(t===e)return;const n=t.getAttribute("data-toggle");n&&C(n).forEach(t=>{t.style.display="none"})}),C(t).forEach(t=>{const e=t;e.style.display="none"===e.style.display?"block":"none"})}if(e.dataset.show&&C(e.dataset.show).forEach(t=>{t.style.display="block"}),e.dataset.hide&&C(e.dataset.hide).forEach(t=>{t.style.display="none"}),e.dataset.close)if("parent"===e.dataset.close){const t=e.parentElement;t&&(t.style.display="none")}else C(e.dataset.close).forEach(t=>{t.style.display="none"});if(e.dataset.toggleClass){const t=e.dataset.toggleClass,n=e.getAttribute("data-target");n&&C(n).forEach(e=>{e.classList.toggle(t)})}if(e.dataset.scrollto){const t=x(e.dataset.scrollto);t&&t.scrollIntoView({behavior:"smooth"})}}}),document.addEventListener("click",t=>{const e=t.target;document.querySelectorAll("[data-close-outside]").forEach(t=>{if("none"===t.style.display)return;const n=t.getAttribute("data-close-outside"),a=t.getAttribute("data-close-outside-ignore"),s=t.getAttribute("data-close-outside-emit"),o=t.getAttribute("data-close-outside-action");if(a&&e.closest(a))return;let i=!1;if(n&&"self"!==n){const t=x(n);t&&!t.contains(e)&&(i=!0)}else t.contains(e)||(i=!0);if(i){if(t.style.display="none",o){const e=t.closest("[data-impulse-id]");if(e){const t=e.getAttribute("data-impulse-id");if(t){const e=o.match(/^(\w+)(?:\((.*)\))?$/);if(e){const[,n,a]=e,s=a?a.replace(/['"]/g,""):void 0;window.Impulse?.updateComponent&&window.Impulse.updateComponent(t,n,s)}}}}if(s){const a=t.closest("[data-impulse-id]");if(a&&s.includes("(")){const t=a.getAttribute("data-impulse-id"),e=s.match(/^(\w+)\((.*)\)$/);if(e&&t){const[,n,a]=e,s=a?a.replace(/['"]/g,""):void 0;window.Impulse?.updateComponent&&window.Impulse.updateComponent(t,n,s)}}else window.Impulse?.emit&&window.Impulse.emit(s,{element:t,target:e,selector:n})}}})}),document.querySelectorAll("[data-if], [data-unless]").forEach(t=>{const e=t.getAttribute("data-if"),n=t.getAttribute("data-unless"),a=e||n;if(!a)return;const[s,o]=a.split(":"),i=x(s);if(!i)return;const r=()=>{const n=!!i[o],a=e?n:!n;t.style.display=a?"block":"none"};i.addEventListener("change",r),r()}),k.initializeExistingToasts(),k.observeToasts(),window.__impulseComponents??=new Set,document.querySelectorAll("[data-impulse-id]").forEach(t=>{const e=t.getAttribute("data-impulse-id");e&&window.__impulseComponents.add(e)}),setTimeout(()=>{r()},100)}window.Impulse&&(window.addEventListener("beforeunload",function(){k.clearAllTimers()}),window.Impulse.on("toast:show",()=>{setTimeout(()=>k.initializeExistingToasts(),50)})),window.ImpulseToast={init:t=>k.initializeToast(t),clearTimer:t=>k.clearTimer(t),clearAllTimers:()=>k.clearAllTimers()},function(){const t={emit:T,updateComponent:I,_eventListeners:{},on(t,e){this._eventListeners[t]||(this._eventListeners[t]=[]),this._eventListeners[t].push(e)},off(t,e){this._eventListeners[t]&&(this._eventListeners[t]=this._eventListeners[t].filter(t=>t!==e))},emitEvent(t,e){const n=this._eventListeners[t]||[];for(const t of n)t(e)}},e=t.emit;t.emit=(n,a,s={})=>(t.emitEvent(n,a),e(n,a,s)),"undefined"!=typeof window&&(window.Impulse=t,setTimeout(()=>{document.dispatchEvent(new CustomEvent("data-action-ready",{detail:{Impulse:window.Impulse}}))},0)),"undefined"!=typeof module&&module.exports&&(module.exports={Impulse:t})}(),"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",async()=>{v(),await p(),N()}):(v(),p().then(()=>{N()})))}();
//# sourceMappingURL=impulse.js.map
